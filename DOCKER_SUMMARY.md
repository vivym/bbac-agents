# ğŸ³ Docker éƒ¨ç½²æ€»ç»“

## å·²å®Œæˆçš„ Docker éƒ¨ç½²é…ç½®

### ğŸ“ æ–°å¢æ–‡ä»¶

1. **Dockerfile** - å¤šé˜¶æ®µæ„å»ºï¼Œä¼˜åŒ–é•œåƒå¤§å°
2. **docker-compose.yml** - å®¹å™¨ç¼–æ’é…ç½®
3. **.dockerignore** - æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶
4. **deploy.sh** - ä¸€é”®éƒ¨ç½²è„šæœ¬
5. **health-check.sh** - å¥åº·æ£€æŸ¥è„šæœ¬
6. **DEPLOYMENT.md** - è¯¦ç»†éƒ¨ç½²æŒ‡å—

### ğŸ”§ æ ¸å¿ƒç‰¹æ€§

#### 1. æ–‡ä»¶å…±äº«æœºåˆ¶
```yaml
volumes:
  - ./agents.txt:/app/data/agents.txt:rw
```
- æœ¬åœ° `agents.txt` ç›´æ¥æŒ‚è½½åˆ°å®¹å™¨å†…
- æ”¯æŒå®æ—¶ä¿®æ”¹ï¼Œæ— éœ€é‡æ–°æ„å»ºé•œåƒ
- è¯»å†™æƒé™ï¼Œç¡®ä¿é…ç½®æŒä¹…åŒ–

#### 2. ç¯å¢ƒé€‚é…
```typescript
// è‡ªåŠ¨æ£€æµ‹ Docker ç¯å¢ƒ
const isDocker = process.env.NODE_ENV === 'production' && process.env.DOCKER === 'true'
const filePath = isDocker
  ? '/app/data/agents.txt'  // Docker ç¯å¢ƒ
  : join(process.cwd(), 'agents.txt')  // å¼€å‘ç¯å¢ƒ
```

#### 3. ç”Ÿäº§ä¼˜åŒ–
- Next.js standalone è¾“å‡ºæ¨¡å¼
- å¤šé˜¶æ®µ Docker æ„å»º
- å¥åº·æ£€æŸ¥æœºåˆ¶
- è‡ªåŠ¨é‡å¯ç­–ç•¥

### ğŸš€ ä½¿ç”¨æ–¹æ³•

#### å¿«é€Ÿéƒ¨ç½²
```bash
# ä¸€é”®éƒ¨ç½²
./deploy.sh

# æˆ–æ‰‹åŠ¨éƒ¨ç½²
docker-compose up -d --build
```

#### é…ç½®ç®¡ç†
```bash
# ä¿®æ”¹é…ç½®
vim agents.txt

# åº”ç”¨æ›´æ”¹
docker-compose restart
```

#### æœåŠ¡ç®¡ç†
```bash
# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

### ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- âœ… Docker å’Œ Docker Compose å·²å®‰è£…
- âœ… agents.txt é…ç½®æ–‡ä»¶å­˜åœ¨
- âœ… ç«¯å£ 3000 æœªè¢«å ç”¨
- âœ… æ–‡ä»¶æƒé™æ­£ç¡® (644)
- âœ… ç½‘ç»œè¿æ¥æ­£å¸¸

### ğŸ” æ•…éšœæ’é™¤

1. **å®¹å™¨å¯åŠ¨å¤±è´¥**
   ```bash
   docker-compose logs bbac-agents
   ```

2. **é…ç½®ä¸ç”Ÿæ•ˆ**
   ```bash
   docker-compose exec bbac-agents ls -la /app/data/
   ```

3. **ç«¯å£å†²çª**
   ```bash
   # ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£æ˜ å°„
   ports:
     - "8080:3000"
   ```

### ğŸ¯ ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **ä½¿ç”¨åå‘ä»£ç†** (Nginx/Traefik)
2. **é…ç½® SSL è¯ä¹¦**
3. **è®¾ç½®æ—¥å¿—è½®è½¬**
4. **å®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶**
5. **ç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€**

### ğŸ“Š æ€§èƒ½ç‰¹ç‚¹

- **é•œåƒå¤§å°**: ~200MB (ä¼˜åŒ–å)
- **å¯åŠ¨æ—¶é—´**: ~10-15ç§’
- **å†…å­˜å ç”¨**: ~100-150MB
- **CPU ä½¿ç”¨**: ä½è´Ÿè½½
- **å¥åº·æ£€æŸ¥**: 30ç§’é—´éš”

### ğŸ”’ å®‰å…¨é…ç½®

- iframe æ²™ç®±ç­–ç•¥
- æ–‡ä»¶ç³»ç»Ÿæƒé™æ§åˆ¶
- ç¯å¢ƒå˜é‡éš”ç¦»
- é root ç”¨æˆ·è¿è¡Œ

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

ç°åœ¨ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éƒ¨ç½²å’Œç®¡ç† RAGFlow Chat Agentsï¼š

1. **å¼€å‘ç¯å¢ƒ**: `npm run dev`
2. **Docker éƒ¨ç½²**: `./deploy.sh`
3. **é…ç½®ç®¡ç†**: ç›´æ¥ç¼–è¾‘ `agents.txt`
4. **æœåŠ¡ç›‘æ§**: `docker-compose logs -f`

è®¿é—® http://localhost:3000 å¼€å§‹ä½¿ç”¨ï¼
